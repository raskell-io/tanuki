{% extends "base.html" %}

{% block title %}{{ page.title }}{% endblock %}

{% block body_class %}page-{{ page.slug }}{% endblock %}

{% set mode = config.extra.mode | default(value="site") %}

{% block sidebar %}
{% if mode == "docs" %}
{% include "partials/sidebar.html" %}
{% endif %}
{% endblock %}

{% block nav_buttons %}
{% if mode == "docs" or mode == "book" %}
{% include "partials/nav-buttons.html" %}
{% endif %}
{% endblock %}

{% block content %}
<article class="article" itemscope itemtype="https://schema.org/Article" aria-labelledby="article-title">
    {% if mode == "site" or mode == "blog" %}
    <header class="article__header">
        <h1 id="article-title" itemprop="headline">{{ page.title }}</h1>

        {% if page.description %}
        <p class="article__description" itemprop="description">{{ page.description }}</p>
        {% endif %}

        <div class="article__meta">
            {% if page.date is defined and page.date %}
            <time datetime="{{ page.date | date(format='%Y-%m-%d') }}" itemprop="datePublished">{{ page.date | date(format="%B %d, %Y") }}</time>
            {% endif %}

            {% if page.reading_time %}
            <span aria-hidden="true">&middot;</span>
            <span><span class="sr-only">Estimated reading time: </span>{{ page.reading_time }} min read</span>
            {% endif %}

            {% if page.taxonomies.tags %}
            <span aria-hidden="true">&middot;</span>
            <span itemprop="keywords">
                {% for tag in page.taxonomies.tags %}
                <a href="{{ get_taxonomy_url(kind='tags', name=tag) | safe }}" class="tag" rel="tag">{{ tag }}</a>{% if not loop.last %} {% endif %}
                {% endfor %}
            </span>
            {% endif %}
        </div>
    </header>
    {% else %}
    {# For docs/book mode, show title as visible heading #}
    <header class="article__header article__header--docs">
        <h1 id="article-title" itemprop="headline">{{ page.title }}</h1>
        {% if page.description %}
        <p class="article__description" itemprop="description">{{ page.description }}</p>
        {% endif %}
    </header>
    {% endif %}

    <div class="article__content" itemprop="articleBody">
        {{ page.content | safe }}
    </div>

    {% if page.taxonomies.tags and (mode == "site" or mode == "blog") %}
    <footer class="article__footer">
        <nav class="article__tags" aria-label="Article tags">
            {% for tag in page.taxonomies.tags %}
            <a href="{{ get_taxonomy_url(kind='tags', name=tag) | safe }}" class="tag" rel="tag">{{ tag }}</a>
            {% endfor %}
        </nav>
    </footer>
    {% endif %}

    {# Hidden metadata for structured data #}
    {% if config.extra.author is defined and config.extra.author %}
    <meta itemprop="author" content="{{ config.extra.author }}">
    {% endif %}
    {% if page.updated is defined and page.updated %}
    <meta itemprop="dateModified" content="{{ page.updated | date(format='%Y-%m-%d') }}">
    {% endif %}
</article>

{# Bottom navigation for docs/book #}
{% if mode == "docs" or mode == "book" %}
<nav class="page-nav" aria-label="Page navigation">
    {% if page.earlier %}
    <a href="{{ page.earlier.permalink | safe }}" class="page-nav__link page-nav__link--prev" rel="prev" aria-label="Previous page: {{ page.earlier.title }}">
        <span class="page-nav__label" aria-hidden="true">Previous</span>
        <span class="page-nav__title">{{ page.earlier.title }}</span>
    </a>
    {% endif %}

    {% if page.later %}
    <a href="{{ page.later.permalink | safe }}" class="page-nav__link page-nav__link--next" rel="next" aria-label="Next page: {{ page.later.title }}">
        <span class="page-nav__label" aria-hidden="true">Next</span>
        <span class="page-nav__title">{{ page.later.title }}</span>
    </a>
    {% endif %}
</nav>
{% endif %}
{% endblock %}
