{% extends "base.html" %}

{% block title %}{{ section.title }}{% endblock %}

{% set mode = config.extra.mode | default(value="site") %}

{% block sidebar %}
{% if mode == "docs" %}
{% include "partials/sidebar.html" %}
{% endif %}
{% endblock %}

{% block content %}
<article class="section-page">
    {% if mode == "site" or mode == "blog" %}
    <header class="section-page__header">
        <h1>{{ section.title }}</h1>
        {% if section.description %}
        <p class="section-page__description">{{ section.description }}</p>
        {% endif %}
    </header>
    {% endif %}

    {% if section.content %}
    <div class="section-page__content">
        {{ section.content | safe }}
    </div>
    {% endif %}

    {% if mode == "site" or mode == "blog" %}
    {# Blog/Site mode - show posts as cards #}
    {% if section.pages %}
    <div class="card-grid">
        {% for page in section.pages %}
        <article class="card">
            <h2 class="card__title">
                <a href="{{ page.permalink | safe }}">{{ page.title }}</a>
            </h2>
            {% if page.description %}
            <p class="card__description">{{ page.description }}</p>
            {% endif %}
            {% if page.date %}
            <time datetime="{{ page.date }}">{{ page.date | date(format="%B %d, %Y") }}</time>
            {% endif %}
        </article>
        {% endfor %}
    </div>

    {# Pagination #}
    {% if paginator %}
    <nav class="pagination" aria-label="Pagination">
        {% if paginator.previous %}
        <a href="{{ paginator.previous | safe }}" class="btn btn--secondary">Previous</a>
        {% endif %}
        <span class="pagination__info">Page {{ paginator.current_index }} of {{ paginator.number_pagers }}</span>
        {% if paginator.next %}
        <a href="{{ paginator.next | safe }}" class="btn btn--secondary">Next</a>
        {% endif %}
    </nav>
    {% endif %}
    {% endif %}

    {% elif mode == "docs" or mode == "book" %}
    {# Docs/Book mode - show page list #}
    {% if section.pages %}
    <ul class="page-list">
        {% for page in section.pages %}
        <li>
            <a href="{{ page.permalink | safe }}">{{ page.title }}</a>
            {% if page.description %}
            <p>{{ page.description }}</p>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% endif %}

    {# Subsections #}
    {% if section.subsections %}
    {% for subsection_path in section.subsections %}
    {% set subsection = get_section(path=subsection_path) %}
    <section class="subsection">
        <h2>{{ subsection.title }}</h2>
        <ul class="page-list">
            {% for page in subsection.pages %}
            <li>
                <a href="{{ page.permalink | safe }}">{{ page.title }}</a>
            </li>
            {% endfor %}
        </ul>
    </section>
    {% endfor %}
    {% endif %}
    {% endif %}
</article>
{% endblock %}
